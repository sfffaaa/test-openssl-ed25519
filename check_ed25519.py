from binascii import unhexlify
import ed25519
msg = """{
        body: {
                "from": "pub_key_generated_by_library_in_testing_1",
                "to": "pub_key_generated_by_library_in_testing_2",
                "amount": 3,1415,
                "itemHash": "bdad5ccb7a52387f5693eaef54aeee6de73a6ada7acda6d93a665abbdf954094"
                "seed": "2953135335240383704"
        },
        "fee": 0,7182,
        "network_id": 7,
        "protocol_version": 0,
        "service_id": 5,
}"""

# for i in range(50):
#     sk, vk = ed25519.create_keypair()
#     sig = sk.sign(msg)
#     vk.verify(sig, msg)
#     print(len(msg))
#     print(len(sig))

SK_DATA = '037F9AC624FF5C9BC2A2E70B48B44BFA070501D3F8A5CCF510216DA753BECEAD'
PK_DATA = '914FB4D7E13B6C34BE7D2F8D3AE666E4C2D6F9ECA3D26DF905D8AE15F21B6882'
MSG_DATA = '7B0A2020202020202020626F64793A207B0A202020202020202020202020202020202266726F6D223A20227075625F6B65795F67656E6572617465645F62795F6C6962726172795F696E5F74657374696E675F31222C0A2020202020202020202020202020202022746F223A20227075625F6B65795F67656E6572617465645F62795F6C6962726172795F696E5F74657374696E675F32222C0A2020202020202020202020202020202022616D6F756E74223A20332C313431352C0A20202020202020202020202020202020226974656D48617368223A202262646164356363623761353233383766353639336561656635346165656536646537336136616461376163646136643933613636356162626466393534303934220A202020202020202020202020202020202273656564223A202232393533313335333335323430333833373034220A20202020202020207D2C0A202020202020202022666565223A20302C373138322C0A2020202020202020226E6574776F726B5F6964223A20372C0A20202020202020202270726F746F636F6C5F76657273696F6E223A20302C0A202020202020202022736572766963655F6964223A20352C0A7D00'
SIG_DATA = '73854CCEAD9C6E4C6B49C45D4C3D765855E0955A9F3687A5EE8AA05FC98E15D557FECED7863B9B271491D911363B8F04AA13EFC87B6CAE2E31FE9F6091633B0F'
sk_raw = unhexlify(SK_DATA.encode("ascii"))
pk_raw = unhexlify(PK_DATA.encode("ascii"))

sk = ed25519.SigningKey(sk_raw)
pk = sk.get_verifying_key()

newsig = sk.sign(unhexlify(MSG_DATA.encode('ascii')))

print pk.to_bytes() == pk_raw
print newsig == unhexlify(SIG_DATA.encode('ascii'))
pk.verify(unhexlify(SIG_DATA.encode('ascii')), unhexlify(MSG_DATA.encode('ascii')))
print 'success'
